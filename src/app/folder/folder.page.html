<ion-header [translucent]="true">
  <ion-toolbar >
    <ion-buttons slot="end">
      <ion-button size="large" [routerLink]="['/perfil-usuario']">
        <ion-icon name="person-circle-outline"></ion-icon>
      </ion-button>
      <ion-menu-button ></ion-menu-button>
    </ion-buttons>
    <ion-title>PuntoDuoc</ion-title>
  </ion-toolbar>
</ion-header>

<!-- folder.page.html -->
<ion-content [fullscreen]="true" class="content-center">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">{{ folder }}</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Barra de búsqueda y botón de filtros -->
  <div class="search-container">
    <ion-searchbar
      animated="true"
      placeholder="Buscar eventos"
      [(ngModel)]="searchText"
      (ionInput)="filterEvents()">
    </ion-searchbar>

    <ion-button color="light" aria-label="Filter" class="filter-button" (click)="toggleFilters()">
      <ion-icon name="options-outline"></ion-icon>
    </ion-button>
  </div>

  <!-- Contenedor de filtros (se muestra debajo de la barra de búsqueda) -->
  <div class="filter-container" [class.expanded]="showFilters">
    <ion-list>
      <ion-item>
        <ion-label>Región</ion-label>
        <ion-select placeholder="Seleccionar">
          <ion-select-option>Región Metropolitana</ion-select-option>
          <ion-select-option>Región de la Araucanía: Villarrica</ion-select-option>
          <ion-select-option>Región de Los Lagos: Puerto Montt</ion-select-option>
          <ion-select-option>Región de Valparaíso: Valparaíso y Viña del Mar</ion-select-option>
          <ion-select-option>Región del Biobío: Concepción, Arauco y Nacimiento</ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-input placeholder="Lugar"></ion-input>
      </ion-item>
    </ion-list>
  </div>

  <!-- Listado de eventos -->
  <ion-grid>
    <ion-row justify-content-center align-items-center>
      <ion-col size="12" size-md="8" size-lg="6">
        <ion-list>
          <ion-item *ngFor="let event of filteredEvents" lines="none" class="event-item">
            <ion-card class="event-card">
              <img alt="Imagen del evento" [src]="event.imagen" class="event-image"/>
              <ion-card-header>
                <ion-card-title (click)="toggleDescription(event)" class="centered-text">{{ event.titulo }}</ion-card-title>
              </ion-card-header>

              <ion-card-content class="centered-content">
                <p *ngIf="event.show">{{ event.descripcion }}</p>
                <p>Cupos disponibles: {{ event.Cupos }}</p>

                <!-- Mensaje que indica si el usuario ya está inscrito -->
                <p *ngIf="event.estaInscrito" class="inscrito-text">¡Ya estás inscrito en este evento!</p>

                <!-- Mensaje que indica si el usuario está en la lista de espera -->
                <p *ngIf="event.enListaEspera" class="en-lista-espera-text">¡Ya estás en la lista de espera!</p>

                <!-- Mensaje que indica si el evento está lleno -->
                <p *ngIf="event.Cupos === 0" class="lleno-text">Este evento está lleno. Puedes unirte a la lista de espera.</p>

                <!-- Botón de inscripción o cancelación -->
                <ion-button
                  [color]="event.estaInscrito ? 'danger' : (event.Cupos === 0 ? (event.enListaEspera ? 'warning' : 'primary') : 'primary')"
                  (click)="event.estaInscrito ? cancelarInscripcion(event.id_evento) : (event.enListaEspera ? null : presentAlert(event))"
                  expand="block"
                  [disabled]="event.enListaEspera">
                  {{ event.estaInscrito ? 'Cancelar inscripción' : (event.Cupos === 0 ? (event.enListaEspera ? 'Ya estás en la lista de espera' : 'Unirse a lista de espera') : 'Inscribirse') }}
                </ion-button>
              </ion-card-content>
            </ion-card>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>


